name: 'Zephyr Init'
description: 'Initialize Zephyr workspace'
inputs:
  personal_access_token:
    required: true
  manifest_path:
    description: "Path to the manifest file"
    required: false
    default: "workdir"
  workspace-path:
    required: false
    type: string
    description: "Path to the workspace"
    default: "/6tron-workspace/"

runs:
  using: "composite"
  steps:
    - name: Setup permission
      shell: bash
      run: |
        git config --global credential.helper store
        echo "https://$GITHUB_ACTOR:${{ inputs.personal_access_token }}@github.com" >~/.git-credentials

    - name: Init and Update Zephyr Application
      shell: bash
      run: |
        cd ${{ inputs.workspace-path }}
        rm -rf .west
        west init -l ${{ inputs.manifest_path }}
        west update
