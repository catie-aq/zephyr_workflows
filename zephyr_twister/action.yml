name: 'Zephyr Twister'
description: 'Run tests with twister'
inputs:
  test:
    required: false
    type: string
    description: "Test to run"
  options:
    required: false
    type: string
    description: "Extra options to pass to twister"
    default: ""
  board:
    required: false
    type: string
    description: "Board to run the test on"
  path:
    required: false
    type: string
    description: "Path to the test directory"
    default: "samples"
  extra_cmd:
    required: false
    type: string
    description: "Extra command to run before build"
    default: "echo ''"

runs:
  using: "composite"
  steps:
    - name: Run Extra Command
      shell: bash
      run: ${{ inputs.extra_cmd }}
    - name: Run test with twister
      if: ${{ inputs.board }}
      shell: bash
      run: west twister -t ${{ inputs.test }} -b ${{ inputs.board }} -T ${{ inputs.path }} ${{ inputs.options }}
    - name: Run test with twister
      if: ${{ !inputs.board }}
      shell: bash
      run: west twister -t ${{ inputs.test }} -T ${{ inputs.path }} ${{ inputs.options }}
